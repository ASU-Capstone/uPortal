$Id$

uPortal Release Notes
---------------------
Release Notes - uPortal - Version 2.4.4-RC1

** Bug
    * [UP-812] - resource-ref not properly parsed in portlet Deployer
    * [UP-924] - PersonDirNameFinder getName() may return null
    * [UP-927] - PersonDirNameFinder not threadsafe
    * [UP-1088] - PortletPreferencesStoreFactory double checked locking [2-4]
    * [UP-1091] - UserLayoutStoreFactory double checked locking [2-4]
    * [UP-1142] - deployPortletApp can't install correctly web.xml utf-8 encoding.
    * [UP-1167] - GuestUserPreferencesManager loses non-Exception cause
    * [UP-1227] - WebProxy does not close urlconnection inputstream
    * [UP-1252] - Change processing order for uP_save
    * [UP-1305] - LoginServlet doesn't cope with ISE from multiply invalidating session
    * [UP-1309] - LogoutServlet doesn't cope with ISE on sesion.invalidate().

** New Feature
    * [UP-1024] - add CAbstractXslt
    * [UP-1246] - Dynamic channel titles

** Improvement
    * [UP-1135] - JavaDoc UserInstance.systemCache
    * [UP-1136] - JavaDoc UserInstance.systemCharacterCache
    * [UP-1137] - eliminate use of concat operator in default persondirs query to support more dbs by default
    * [UP-1168] - RemoteUserPersonManager support security chains in security.properties
    * [UP-1195] - Make SoftHashMap inherently threadsafe
    * [UP-1240] - upgrade to JAXP 1.3 XML APIs (for uPortal 2.4.x)
    * [UP-1245] - SAX2FilterImpl provide protected Log instance
    * [UP-1261] - Implement layout cachekey optimization to improve layout caching.
    * [UP-1306] - Include URI of missing resource in XSLT missing resource exception message
    * [UP-1308] - ChannelRuntimeProperties protected Log instance

Notes:

	This is the first 2.4.x release to include support for being compiled or 
	running under JDK 1.4 or 1.5. For those not familiar, JDK 1.4 includes support
	for JAXP 1.2 and JDK 1.5 supports JAXP 1.3. JAXP[1] is an API that allows an
	application to process an XML document independent of the underlying XML
	processing engine[2]. The support for DOM Level 3[3] was a main driver for
	introducing the JAXP 1.3 release. Unfortunately, the JAXP 1.3 API is not 
	backwards compatible with JAXP 1.2[4]. 

	This means that an application programmed to use the JAXP 1.3 API will compile/run
	with no problems under JDK 1.5, but fails under an out-of-the-box JDK 1.4 install.
	To remedy this problem (JAXP 1.3 with JDK 1.4), Sun makes available the JAXP 1.3
	libraries, which must be referenced by the JDK 1.4 Java Compiler or Application
	BEFORE the JAXP 1.2 libraries that ship with the JDK. 
	
	For compilation in uPortal, this is done by installing the JAXP 1.3 libraries 
	(/portal/lib/jaxp/*.jar) into the $JDK_HOME/jre/lib/endorsed directory. For 
	running Tomcat, this is done by copying these libraries into the 
	$TOMCAT_HOME/common/endorsed directory[5]. Both of these actions are performed 
	by the ant JAXP-Install target. Technically, the JAXP 1.3 JAR files are being added 
	to the Java bootclasspath, which tells Java to look in there for a class before 
	looking in the runtime JAR ($JAVA_HOME/jre/lib/rt.jar).
	
	Note that all generated .class file compatibility is 1.4.
	
	1. Compile under JDK 1.4:
		- ant JAXP-Install
		- ant initportal (or deploy)
	2. Compile under JDK 1.5:
		- ant initportal (or deploy)
	3. Run under JDK 1.4/Tomcat 5.0.x:
		- must do step 1
	4. Run under JDK 1.5/Tomcat 5.0.x:
		- must do step 2
		- must remove $TOMCAT_HOME/common/endorsed/xercesImpl.jar
		- must remove $TOMCAT_HOME/common/endorsed/xml-apis.jar
	5. Run under JDK 1.5/Tomcat 5.5.x:
		- must do step 2

[1] http://java.sun.com/webservices/jaxp/index.jsp
[2] http://java.sun.com/webservices/jaxp/reference/faqs/index.html
[3] http://www.w3.org/DOM/
[4] http://java.sun.com/j2se/1.5.0/docs/guide/xml/jaxp/JAXP-Compatibility_150.html
[5] http://java.sun.com/j2se/1.4.2/docs/guide/standards/index.html

[a] https://clearinghouse.ja-sig.org/wiki/display/UPC/XML+API+standardization
[b] https://clearinghouse.ja-sig.org/wiki/display/UPC/Compiling+under+JDK+1.5
[c] https://clearinghouse.ja-sig.org/wiki/display/UPC/Practical+uP25+XML+Changes

----------------------------------------------------------------
uPortal Release Notes
---------------------
Release Notes - uPortal - Version 2.4.3.1

**Bug

    * [UP-1253] - CWebProxy security exploit: proxies file system content
    * [UP-245]  - CPD default="true" not functional

Notes:

    1. CWebProxy and CGenericXSLT changed for this release to address 
    security vulnerabilities. These channels honor fewer 
    ChannelRuntimeParameters now. This will not affect most deployments.  
    A few deployments will need to re-examine CWebProxy and re-implement the 
    insecure features that were removed in more secure ways.  CWebProxy 
    also changed to require that the xmlUri be an http:// or https:// URI.  
    You can make this rule more or less restrictive by publish-time 
    configuration of CWebProxy instances.  [UP-1253]

    2. This release and all prior uPortal releases do NOT support JAXP 1.3.
    This means that it will not compile/run under JDK 1.5 OR JDK 1.4 with 
    JAXP 1.3 installed. It will compile/run under JDK 1.4. uPortal 2.4.4 
    is scheduled to include support for JAXP 1.3.
    
    Support for JDK 1.5 or JDK 1.4 w/ JAXP 1.3 is provided in and after
    the uPortal 2.5.0 release.


----------------------------------------------------------------
uPortal Release Notes
---------------------
Release Notes - uPortal - Version 2.4.3

**Bug

    * [UP-694] - NPE persists after publishing fragment with no name and description
    * [UP-735] - Content Subscriber exception when searching for "what's"
    * [UP-754] - Problem on deleting non-empty tabs
    * [UP-818] - HttpProxyServlet ignores query string
    * [UP-823] - MInesweeper codebase web site moved.
    * [UP-849] - RDBMPortletPreferencesStore doesn't support MS-SQL
    * [UP-865] - simple layout manager won't start
    * [UP-921] - very long time to connect: AggregatedUserLayoutStore SQL
    * [UP-931] - ChannelRenderer finalizer is causing lots of loitered objects in memory causing a serious memory leak.
    * [UP-1016] - BoundedThreadPool infinite loop or deadlock [2-4-patches]
    * [UP-1102] - Restore safety to channel rendering
    * [UP-1119] - memory leak happens under stress when CPortletAdapter portlets are asked to clean themselves up when the session ends.
    * [UP-1123] - PortletStateManager.clearState(PortletWindow) implementation is buggy and can lead to ConcurrentModificationException under stress.
    * [UP-1145] - access to SoftHashMap systemCache across threads is not synchronized

**Improvement

    * [UP-734] - Make "Cannot start uPortal" message give HTTP 500 status code
    * [UP-815] - ChannelFactory should log source exception on instantiation failure
    * [UP-992] - MultipartDataSource.finalize( ) is not implemented properly.
    * [UP-1079] - StaticInformationProvider.getPortletDefinition() should give helpful exception if portletGUID doesn't have a "."
    * [UP-1146] - javadoc SoftHashMap to say it isn't synchronized
    * [UP-1177] - org.jasig.portal.MultipartDataSource incorrectly implemented finalize ( ) method.
    * [UP-1178] - HTMLdtd.fromChar(int) method creats un-necessary objects during the lookup.
    * [UP-1179] - Debug statements in the codebase causes un-necessary creation of string objects.
    * [UP-1180] - Reduce object creation in SubstitutionIntegerFilter.java
    * [UP-1181] - Reduce number of MediaManager objects created
    * [UP-1187] - Enhance ChannelRuntimeData by adding a new method that generates the functional-name-focusing URL for channels.

----------------------------------------------------------------
Release Notes - uPortal - Version 2.4.2

** Bug
    * [UP-338] - RENDERING_DONE Event never sent
    * [UP-476] - User's LDAP groups not loaded if username contains uppercase
    * [UP-512] - User agent too long for db column
    * [UP-685] - wrong fname in fragment produces exception with no useful error
                 message
    * [UP-744] - PersonDirectory has a memory leak related to caching IPersons in
                 a WeakHashMap
    * [UP-745] - ChannelManager has a memory leak, when it swaps out a channel
                 for the CError channel, the end session events never progagate
                 to the original channel
    * [UP-746] - CSecureInfo has a memory leak, when ChannelManager swaps out a
                 channel for the CSecureInfo channel, the to end session events 
                 never propagate to the original channel
    * [UP-747] - Change to portlet parameter encoding breaks download worker URLs
    * [UP-748] - Infinite recursion in RestrictedPerson
    * [UP-749] - render parameter does not survive refresh
    * [UP-753] - ChannelFactory should not expose internal map of static channels, 
                 not create more than one instance of a multithreaded channel
    * [UP-758] - CContentSubscriber prints exception to stdout instead of log
    * [UP-759] - Xalan jar should be deployed to endorsed directory
    * [UP-760] - Entity locks not expired correctly
    * [UP-761] - A lock owner is limited to single READ lock on an entity
    * [UP-772] - Classpath resources not being copied to build
    * [UP-775] - Duplicate read locks for a single owner not permitted.
    * [UP-776] - WebApplicationMarshaller.java turns resource-ref into 
                 resource-env-ref
    * [UP-778] - AggregatedLayoutManager.loadUserLayout() fails to log stack 
                 trace for exception
    * [UP-779] - ChannelRenderer declares constants that are already declared 
                 in its base class
    * [UP-780] - Eliminate "unknown additional descriptor warning" when using 
                 ChainingSecurityContext
    * [UP-796] - contains() doesn't always work for PAGS groups
    * [UP-798] - GroupService.isComposite always returns null
    * [UP-811] - NPE when Data tag not present in DatabaseTagHandler

** Improvement
    * [UP-770] - Document hsqldb version included with uPortal
    * [UP-800] - Add comment to clarify usage of Logger.properties
    * [UP-809] - Move portlet request attribute configuration to helper method
    * [UP-810] - Log logging implementation
