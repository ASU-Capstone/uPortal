<project name="uPortal_Includes" basedir="." xmlns:artifact="urn:maven-artifact-ant">
    <dirname property="imported.basedir" file="${ant.file.uPortal_Includes}"/>
    
    <fail message="The nested macros in this build.xml do not work with '${ant.version}', the current recommended version is 1.6.5">
        <condition>
            <or>
                <contains string="${ant.version}" substring="1.7.0" />
                <contains string="${ant.version}" substring="1.6.2" />
                <contains string="${ant.version}" substring="1.6.1" />
                <contains string="${ant.version}" substring="1.6.0" />
                <contains string="${ant.version}" substring="1.5." />
            </or>
        </condition>
    </fail>

    <typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="urn:maven-artifact-ant">
        <classpath>
            <pathelement location="${imported.basedir}/lib/maven-ant-tasks-2.0.8.jar" />
        </classpath>
    </typedef>

    <taskdef resource="net/sf/antcontrib/antlib.xml">
        <classpath>
            <pathelement location="${imported.basedir}/lib/ant-contrib-1.0b3.jar" />
        </classpath>
    </taskdef>

    <macrodef name="echo-path">
        <attribute name="pathref" />
        <sequential>
            <echo>echoing path=@{pathref}</echo>
            <for param="fromfile">
                <path refid="@{pathref}" />
                <sequential>
                    <echo>@{fromfile}</echo>
                </sequential>
            </for>
        </sequential>
    </macrodef>

    <macrodef name="echo-fileset">
        <attribute name="filesetref" />
        <sequential>
            <pathconvert pathsep="\n" property="@{filesetref}.echopath">
                <path>
                    <fileset refid="@{filesetref}" />
                </path>
            </pathconvert>
            <echo>------- echoing fileset @{filesetref} -------</echo>
            <echo>${@{filesetref}.echopath}</echo>
        </sequential>
    </macrodef>
</project>